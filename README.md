
<h1 align="center">Banner service</h1>


## Основные выполненные задания:
✅ Использовал предоставленный API
✅ Если тегов и фичей небольшое количество, то запрос выполняется менее 50 мс, не считая исключительные случаи
✅ Для авторизации доступов используются 2 вида токенов: пользовательский и админский. Получение баннера происходит с помощью пользовательского или админского токена, а все остальные действия выполняются только с помощью админского токена. Визуально, токены разной длины.
✅ Реализовал интеграционный тест на сценарий получения баннера.
✅ Если при получении баннера передан флаг use_last_revision, передается самая актуальная информация. В ином случае происходит передача информации, которая была актуальна 5 минут назад.
✅ Баннеры можно отключить. Если баннер выключен, то обычные пользователи не получают его, при этом админы имеют к нему доступ.

## Дополнительные выполненные задания:
✅ Адаптировал систему для значительного увеличения количества тегов и фичей. Написал кастомную команду для автоматического наполнения БД. По заврешению, команда выводит сообщение с краткой информацией по количеству тегов и фичей. Команда принимает флаг "--clear", который при наличии очищает 2 таблицы, связанные с баннерами.
➖ Провести нагрузочное тестирование полученного решения и приложить результаты тестирования к решению
Иногда получается так, что необходимо вернуться к одной из трех предыдущих версий баннера в связи с найденной ошибкой в логике, тексте и т.д. Измените API таким образом, чтобы можно было просмотреть существующие версии баннера и выбрать подходящую версию
✅ Добавил метод удаления баннеров по фиче или списку тегов, время ответа которого не превышает 100 мс, независимо от количества баннеров. Удаление происходит асинхронно с помощью Celery.
➖ Реализовать интеграционное или E2E-тестирование для остальных сценариев
✅ Описать конфигурацию линтера

<p align="center">
  Решенные возникшие вопросы.
</p>
<p>
  1. Для однозначного поиска, было принято решение, запретить создание записи в БД. Правило запрета: 
  С одной фичей не могут быть одни и те же теги, но одни и те же теги могут быть у разных баннеров, так же и с фичами, одни и те же фичи могут быть у нескольких баннеров одновременно.
  2. В АПИ используются токены. Добавил отдельный урл для получения токенов. Проверка по длине токена. Выполнил задание, что токены должны быть разные.
  3. 
</p>
<p>
  Фич лист проделанной работы:
    1. Кастомная команда - 
    python manage.py put_data --n_features=1000 --clear
    2. Созданы модели;
    3. Созданы урлы;
    4. Созданы вьюшки;
    5. Создано правило создания баннера для однозначного поиска по фиче и тегу;
    6. Кеш для user_banner_view работает;
    7. Проверка пользователя по токену в 1 вьюшке.
</p>

Запустите Celery для выполнения периодических задач:
celery -A main(config?) beat -l info

Запуск рабочих процессов Celery для выполнения задач:
celery -A main  worker --purge
celery -A main  worker --loglevel=info
